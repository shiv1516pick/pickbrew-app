<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PickBrew App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <link rel="stylesheet" href="style.css" />
</head>

<body class="bg-black text-white">
    <div class="lg:hidden max-w-md mx-auto h-screen bg-black flex flex-col overflow-hidden">
        <div class="h-28 shrink-0 bg-[#5a7479] flex items-center justify-center">
            <h1 class="text-2xl font-semibold">Profile</h1>
        </div>
        <div class="bg-[#121212] rounded-t-[2.5rem] -mt-6 flex-1 overflow-y-auto">
            <div class="px-6 pt-8 pb-6">

                <!-- Avatar & user info -->
                <div class="flex items-center gap-4 mb-6">
                    <div id="prof-avatar"
                        class="w-16 h-16 rounded-full bg-[#af7b5c] flex items-center justify-center text-black text-2xl font-bold">
                        ?</div>
                    <div class="flex-1">
                        <h2 id="prof-name" class="text-lg font-semibold">Guest</h2>
                        <p id="prof-email" class="text-sm text-gray-400">Not signed in</p>
                    </div>
                    <button id="edit-btn" class="ml-auto text-[#c8a27a]">
                        <span class="material-symbols-outlined text-[20px]">edit</span>
                    </button>
                </div>

                <hr class="border-gray-700 mb-6" />

                <!-- Account section -->
                <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-4">Account</h3>
                <a href="#" id="personal-info-btn" class="flex items-center justify-between py-3">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-[20px] text-[#af7b5c]">person</span>
                        <span class="text-sm">Personal Information</span>
                    </div>
                    <span class="material-symbols-outlined text-[18px] text-gray-500">chevron_right</span>
                </a>
                <a href="#" class="flex items-center justify-between py-3">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-[20px] text-[#af7b5c]">location_on</span>
                        <span class="text-sm">Delivery Addresses</span>
                    </div>
                    <span class="material-symbols-outlined text-[18px] text-gray-500">chevron_right</span>
                </a>
                <a href="#" class="flex items-center justify-between py-3">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-[20px] text-[#af7b5c]">credit_card</span>
                        <span class="text-sm">Payment Methods</span>
                    </div>
                    <span class="material-symbols-outlined text-[18px] text-gray-500">chevron_right</span>
                </a>

                <hr class="border-gray-700 my-4" />

                <!-- Orders section -->
                <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-4">Orders</h3>
                <a href="previous.html" class="flex items-center justify-between py-3">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-[20px] text-[#af7b5c]">receipt_long</span>
                        <span class="text-sm">Order History</span>
                    </div>
                    <span class="material-symbols-outlined text-[18px] text-gray-500">chevron_right</span>
                </a>
                <a href="favorites.html" class="flex items-center justify-between py-3">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-[20px] text-[#af7b5c]">favorite</span>
                        <span class="text-sm">My Favorites</span>
                    </div>
                    <span class="material-symbols-outlined text-[18px] text-gray-500">chevron_right</span>
                </a>

                <hr class="border-gray-700 my-4" />

                <!-- Preferences section -->
                <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-4">Preferences</h3>
                <div class="flex items-center justify-between py-3">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-[20px] text-[#af7b5c]">notifications</span>
                        <span class="text-sm">Notifications</span>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input id="notif-toggle" type="checkbox" checked class="sr-only peer" />
                        <div
                            class="w-10 h-5 bg-gray-600 rounded-full peer peer-checked:bg-[#af7b5c] after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:after:translate-x-5">
                        </div>
                    </label>
                </div>
                <a href="#" class="flex items-center justify-between py-3">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-[20px] text-[#af7b5c]">language</span>
                        <span class="text-sm">Language</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <span class="text-sm text-gray-400">English</span>
                        <span class="material-symbols-outlined text-[18px] text-gray-500">chevron_right</span>
                    </div>
                </a>

                <hr class="border-gray-700 my-4" />

                <!-- Support section -->
                <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-4">Support</h3>
                <a href="#" class="flex items-center justify-between py-3">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-[20px] text-[#af7b5c]">help</span>
                        <span class="text-sm">Help Center</span>
                    </div>
                    <span class="material-symbols-outlined text-[18px] text-gray-500">chevron_right</span>
                </a>
                <a href="#" class="flex items-center justify-between py-3">
                    <div class="flex items-center gap-3">
                        <span class="material-symbols-outlined text-[20px] text-[#af7b5c]">policy</span>
                        <span class="text-sm">Privacy Policy</span>
                    </div>
                    <span class="material-symbols-outlined text-[18px] text-gray-500">chevron_right</span>
                </a>

                <hr class="border-gray-700 my-4" />

                <!-- Logout -->
                <button id="logout-btn" class="flex items-center gap-3 py-3 text-red-400 w-full">
                    <span class="material-symbols-outlined text-[20px]">logout</span>
                    <span class="text-sm font-semibold">Log Out</span>
                </button>

                <!-- App version -->
                <p class="text-center text-xs text-gray-600 mt-6">PickBrew v1.0.0</p>

            </div>
        </div>

        <!-- Edit Profile Modal -->
        <div id="edit-modal" class="fixed inset-0 bg-black/70 z-50 flex items-end justify-center" style="display:none;">
            <div class="bg-[#1e1e1e] rounded-t-3xl w-full max-w-md px-6 pt-6 pb-8">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-semibold">Edit Profile</h3>
                    <button id="edit-close" class="text-gray-400">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="mb-4">
                    <label class="block text-sm text-gray-300 mb-2">Full Name</label>
                    <input id="edit-name" type="text"
                        class="w-full bg-[#121212] border border-gray-700 rounded-xl px-4 py-3 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#af7b5c]" />
                </div>
                <div class="mb-4">
                    <label class="block text-sm text-gray-300 mb-2">Email</label>
                    <input id="edit-email" type="email"
                        class="w-full bg-[#121212] border border-gray-700 rounded-xl px-4 py-3 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#af7b5c]" />
                </div>
                <div class="mb-6">
                    <label class="block text-sm text-gray-300 mb-2">Phone</label>
                    <input id="edit-phone" type="tel"
                        class="w-full bg-[#121212] border border-gray-700 rounded-xl px-4 py-3 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#af7b5c]" />
                </div>
                <button id="edit-save"
                    class="w-full py-3 bg-[#af7b5c] text-black text-center rounded-full font-semibold text-base">
                    Save Changes
                </button>
            </div>
        </div>

        <!-- Personal Info Modal -->
        <div id="info-modal" class="fixed inset-0 bg-black/70 z-50 flex items-end justify-center" style="display:none;">
            <div class="bg-[#1e1e1e] rounded-t-3xl w-full max-w-md px-6 pt-6 pb-8">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-semibold">Personal Information</h3>
                    <button id="info-close" class="text-gray-400">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
                <div class="space-y-4">
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-400">Name</span>
                        <span id="info-name" class="text-sm font-medium">—</span>
                    </div>
                    <hr class="border-gray-700" />
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-400">Email</span>
                        <span id="info-email" class="text-sm font-medium">—</span>
                    </div>
                    <hr class="border-gray-700" />
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-400">Phone</span>
                        <span id="info-phone" class="text-sm font-medium">—</span>
                    </div>
                    <hr class="border-gray-700" />
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-400">Member since</span>
                        <span id="info-joined" class="text-sm font-medium">—</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom nav -->
        <div class="shrink-0 bg-black border-t border-gray-800 flex justify-around py-3">
            <a href="index.html" class="nav-item">
                <span class="material-symbols-outlined">local_cafe</span>
            </a>
            <a href="menu.html" class="nav-item">
                <span class="material-symbols-outlined">menu_book_2</span>
            </a>
            <a href="favorites.html" class="nav-item">
                <span class="material-symbols-outlined">favorite</span>
            </a>
            <a href="cart.html" class="nav-item relative">
                <span class="material-symbols-outlined">shopping_cart</span>
                <span class="cart-badge absolute -top-1 -right-2 bg-[#af7b5c] text-xs rounded-full px-1"></span>
            </a>
            <a href="profile.html" class="nav-item">
                <span class="material-symbols-outlined">account_circle</span>
            </a>
        </div>
    </div>
    <div class="hidden lg:flex min-h-screen items-center justify-center bg-black text-white">
        <p class="opacity-70">Mobile & Tablet only</p>
    </div>
    <script src="app.js"></script>
    <script src="index.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var avatar = document.getElementById("prof-avatar");
            var nameEl = document.getElementById("prof-name");
            var emailEl = document.getElementById("prof-email");
            var notifToggle = document.getElementById("notif-toggle");

            function getInitials(name) {
                var parts = name.trim().split(" ");
                if (parts.length >= 2) return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();
                return name.substring(0, 2).toUpperCase();
            }

            function renderProfile() {
                var user = PickBrew.getUser();
                if (user) {
                    avatar.textContent = getInitials(user.name);
                    nameEl.textContent = user.name;
                    emailEl.textContent = user.email;
                } else {
                    avatar.textContent = "?";
                    nameEl.textContent = "Guest";
                    emailEl.textContent = "Not signed in";
                }
            }

            renderProfile();

            // Notification toggle - persist
            var notifPref = PickBrew.getPref("notifications");
            if (notifPref !== undefined) {
                notifToggle.checked = notifPref;
            }
            notifToggle.addEventListener("change", function () {
                PickBrew.setPref("notifications", notifToggle.checked);
                PickBrew.showToast(notifToggle.checked ? "Notifications enabled" : "Notifications disabled");
            });

            // Logout
            document.getElementById("logout-btn").addEventListener("click", function () {
                PickBrew.logout();
                PickBrew.showToast("Logged out");
                setTimeout(function () { window.location.href = "login.html"; }, 600);
            });

            // Edit modal
            var editModal = document.getElementById("edit-modal");
            document.getElementById("edit-btn").addEventListener("click", function (e) {
                e.preventDefault();
                var user = PickBrew.getUser();
                if (!user) {
                    PickBrew.showToast("Please sign in first");
                    setTimeout(function () { window.location.href = "login.html"; }, 600);
                    return;
                }
                document.getElementById("edit-name").value = user.name || "";
                document.getElementById("edit-email").value = user.email || "";
                document.getElementById("edit-phone").value = user.phone || "";
                editModal.style.display = "";
            });
            document.getElementById("edit-close").addEventListener("click", function () {
                editModal.style.display = "none";
            });
            editModal.addEventListener("click", function (e) {
                if (e.target === editModal) editModal.style.display = "none";
            });
            document.getElementById("edit-save").addEventListener("click", function () {
                var user = PickBrew.getUser();
                var newName = document.getElementById("edit-name").value.trim();
                var newEmail = document.getElementById("edit-email").value.trim();
                var newPhone = document.getElementById("edit-phone").value.trim();
                if (!newName) { PickBrew.showToast("Name is required"); return; }
                if (!newEmail || newEmail.indexOf("@") === -1) { PickBrew.showToast("Valid email is required"); return; }
                user.name = newName;
                user.email = newEmail;
                user.phone = newPhone;
                PickBrew.saveUser(user);
                editModal.style.display = "none";
                renderProfile();
                PickBrew.showToast("Profile updated!");
            });

            // Personal Info modal
            var infoModal = document.getElementById("info-modal");
            document.getElementById("personal-info-btn").addEventListener("click", function (e) {
                e.preventDefault();
                var user = PickBrew.getUser();
                if (!user) {
                    PickBrew.showToast("Please sign in first");
                    return;
                }
                document.getElementById("info-name").textContent = user.name || "—";
                document.getElementById("info-email").textContent = user.email || "—";
                document.getElementById("info-phone").textContent = user.phone || "—";
                if (user.joined) {
                    var d = new Date(user.joined);
                    document.getElementById("info-joined").textContent = d.toLocaleDateString("en-US", { month: "long", day: "numeric", year: "numeric" });
                }
                infoModal.style.display = "";
            });
            document.getElementById("info-close").addEventListener("click", function () {
                infoModal.style.display = "none";
            });
            infoModal.addEventListener("click", function (e) {
                if (e.target === infoModal) infoModal.style.display = "none";
            });
        });
    </script>
</body>

</html>
