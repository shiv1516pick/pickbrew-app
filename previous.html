<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PickBrew App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <link rel="stylesheet" href="style.css" />
</head>

<body class="bg-black text-white">
    <div class="lg:hidden max-w-md mx-auto h-screen bg-black flex flex-col overflow-hidden">
        <div class="shrink-0 bg-[#5a7479] pt-5 pb-10">
            <h1 class="text-2xl font-semibold text-center">Previous Orders</h1>
        </div>
        <div id="orders-area" class="bg-[#121212] rounded-t-[2.5rem] -mt-6 flex-1 overflow-y-auto">
        </div>
        <div class="shrink-0 bg-black border-t border-gray-800 flex justify-around py-3">
            <a href="index.html" class="nav-item">
                <span class="material-symbols-outlined">local_cafe</span>
            </a>
            <a href="menu.html" class="nav-item">
                <span class="material-symbols-outlined">menu_book_2</span>
            </a>
            <a href="favorites.html" class="nav-item">
                <span class="material-symbols-outlined">favorite</span>
            </a>
            <a href="cart.html" class="nav-item relative">
                <span class="material-symbols-outlined">shopping_cart</span>
                <span class="cart-badge absolute -top-1 -right-2 bg-[#af7b5c] text-xs rounded-full px-1"></span>
            </a>
            <a href="profile.html" class="nav-item">
                <span class="material-symbols-outlined">account_circle</span>
            </a>
        </div>
    </div>
    <div class="hidden lg:flex min-h-screen items-center justify-center bg-black text-white">
        <p class="opacity-70">Mobile & Tablet only</p>
    </div>
    <script src="app.js"></script>
    <script src="index.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var orders = PickBrew.getOrders();
            var area = document.getElementById("orders-area");

            if (orders.length === 0) {
                area.className = "bg-[#121212] rounded-t-[2.5rem] -mt-6 flex-1 overflow-y-auto flex justify-center items-center";
                area.innerHTML = '<div class="text-center px-6">' +
                    '<span class="material-symbols-outlined text-[48px] text-gray-600 mb-3 block">receipt_long</span>' +
                    '<p class="text-[#c8a27a] text-sm leading-relaxed">You don\'t have any previous orders yet</p>' +
                    '<a href="menu.html" class="inline-block mt-4 px-6 py-2 bg-[#af7b5c] text-black text-sm font-semibold rounded-full">Start Ordering</a>' +
                    '</div>';
                return;
            }

            var html = '<div class="px-6 pt-8 pb-4">';
            orders.forEach(function (order) {
                var d = new Date(order.date);
                var dateStr = d.toLocaleDateString("en-US", { month: "short", day: "numeric", year: "numeric" });
                var timeStr = d.toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit" });
                var itemCount = 0;
                order.items.forEach(function (it) { itemCount += it.qty; });

                html += '<div class="mb-5 bg-[#1e1e1e] rounded-2xl p-4">' +
                    '<div class="flex justify-between items-center mb-3">' +
                    '<div>' +
                    '<p class="text-sm font-semibold">' + order.id + '</p>' +
                    '<p class="text-xs text-gray-400">' + dateStr + ' at ' + timeStr + '</p>' +
                    '</div>' +
                    '<span class="text-xs px-2 py-0.5 rounded-full bg-green-900 text-green-300">Completed</span>' +
                    '</div>';

                html += '<div class="flex gap-2 mb-3 overflow-x-auto">';
                order.items.forEach(function (it) {
                    html += '<img src="' + it.image + '" class="w-10 h-10 rounded-full object-cover shrink-0" title="' + it.name + '" />';
                });
                html += '</div>';

                html += '<div class="space-y-1 mb-3">';
                order.items.forEach(function (it) {
                    html += '<div class="flex justify-between text-sm">' +
                        '<span class="text-gray-300">' + it.qty + 'x ' + it.name + '</span>' +
                        '<span class="text-gray-400">$' + (it.price * it.qty).toFixed(2) + '</span>' +
                        '</div>';
                });
                html += '</div>';

                html += '<hr class="border-gray-700 mb-3" />' +
                    '<div class="flex justify-between items-center">' +
                    '<span class="text-sm font-semibold">Total: $' + order.total.toFixed(2) + '</span>' +
                    '<button class="reorder-btn px-4 py-1.5 bg-[#af7b5c] text-black text-xs font-semibold rounded-full" data-order=\'' + JSON.stringify(order.items) + '\'>Reorder</button>' +
                    '</div>' +
                    '</div>';
            });
            html += '</div>';
            area.innerHTML = html;

            area.querySelectorAll(".reorder-btn").forEach(function (btn) {
                btn.addEventListener("click", function () {
                    var items = JSON.parse(btn.dataset.order);
                    items.forEach(function (it) { PickBrew.addToCart(it); });
                    PickBrew.showToast("Items added to cart!");
                });
            });
        });
    </script>
</body>

</html>
