<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PickBrew App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <link rel="stylesheet" href="style.css" />
</head>

<body class="bg-black text-white">
    <div class="lg:hidden max-w-md mx-auto h-screen bg-black flex flex-col overflow-hidden">
        <div class="relative shrink-0">
            <img id="hero-img" src="https://images.unsplash.com/photo-1511920170033-f8396924c348"
                class="w-full h-56 object-cover" />
            <a href="menu.html"
                class="absolute top-4 left-4 w-9 h-9 bg-black/50 rounded-full flex items-center justify-center">
                <span class="material-symbols-outlined text-white text-[20px]">arrow_back</span>
            </a>
            <button id="fav-btn"
                class="absolute top-4 right-4 w-9 h-9 bg-black/50 rounded-full flex items-center justify-center">
                <span id="fav-icon" class="material-symbols-outlined text-white text-[20px]">favorite_border</span>
            </button>
        </div>
        <div class="bg-[#121212] rounded-t-[2.5rem] -mt-8 flex-1 overflow-y-auto relative z-10">
            <div id="product-loader" class="loader" style="min-height:300px;">
                <div class="loader-spinner"></div>
                <span class="loader-text">Loading product...</span>
            </div>
            <div id="product-content" class="px-6 pt-6 pb-6" style="display:none;">

                <!-- details of the product is here -->
                <div class="flex items-center gap-1.5 mb-4">
                    <a href="index.html" class="text-xs text-gray-500">Home</a>
                    <span class="material-symbols-outlined text-[12px] text-gray-600">chevron_right</span>
                    <a href="menu.html" class="text-xs text-gray-500">Menu</a>
                    <span class="material-symbols-outlined text-[12px] text-gray-600">chevron_right</span>
                    <span id="breadcrumb-product" class="text-xs text-[#c8a27a]">Brewed Coffee</span>
                </div>
                <div class="flex justify-between items-start mb-1">
                    <h1 id="product-name" class="text-xl font-semibold">Brewed Coffee</h1>
                    <span id="base-price-display" class="text-xl font-semibold">$4.29</span>
                </div>
                <p id="product-desc" class="text-sm text-gray-400 mb-3">Fresh brewed house blend coffee</p>
                <div id="prep-time" class="inline-flex items-center gap-1.5 bg-[#1e1e1e] border border-gray-700 rounded-full px-3 py-1.5 mb-6">
                    <span class="material-symbols-outlined text-[#af7b5c] text-[16px]">schedule</span>
                    <span class="text-xs text-gray-300">Prep time: <span id="prep-value" class="text-white font-semibold">~5 min</span></span>
                </div>
                <div class="mb-7">
                    <h3 class="text-sm font-semibold text-gray-300 mb-3">Variations</h3>
                    <div class="grid grid-cols-4 gap-2 option-group" data-option="size">
                        <button data-value="Small" data-extra="0"
                            class="opt-btn size-card py-3 rounded-xl text-center border border-gray-600 text-gray-300">
                            <div class="text-base font-bold leading-tight">S</div>
                            <div class="text-[10px]">8 oz</div>
                        </button>
                        <button data-value="Medium" data-extra="0.50"
                            class="opt-btn size-card py-3 rounded-xl text-center bg-[#af7b5c] text-black">
                            <div class="text-base font-bold leading-tight">M</div>
                            <div class="text-[10px]">12 oz</div>
                        </button>
                        <button data-value="Large" data-extra="1.00"
                            class="opt-btn size-card py-3 rounded-xl text-center border border-gray-600 text-gray-300">
                            <div class="text-base font-bold leading-tight">L</div>
                            <div class="text-[10px]">16 oz</div>
                        </button>
                        <button data-value="Extra Large" data-extra="1.50"
                            class="opt-btn size-card py-3 rounded-xl text-center border border-gray-600 text-gray-300">
                            <div class="text-base font-bold leading-tight">XL</div>
                            <div class="text-[10px]">20 oz</div>
                        </button>
                    </div>
                </div>
                <div class="mb-7">
                    <h3 class="text-sm font-semibold text-gray-300 border-b border-gray-600 pb-5">Add-ins</h3>
                    <div class="addin-toggle py-4 border-b border-gray-600 pl-2 flex flex-col cursor-pointer">
                        <div class="flex justify-between items-center">
                            <h4 class="font-semibold">Milks and Creamers</h4>
                            <span
                                class="material-symbols-outlined text-white text-[20px] addin-arrow">chevron_right</span>
                        </div>
                        <div class="addin-body pt-3 hidden">
                            <div class="bg-black py-3 px-4 rounded flex justify-between items-center my-2">
                                <h4 class="text-sm tracking-wide">Oat Milk</h4>
                                <div class="flex items-center gap-2">
                                    <span class="text-xs text-gray-400">$0.50</span>
                                    <input type="checkbox" class="chk" data-addon="Oat Milk" data-extra="0.50" />
                                </div>
                            </div>
                            <div class="bg-black py-3 px-4 rounded flex justify-between items-center my-2">
                                <h4 class="text-sm tracking-wide">1% Milk</h4>
                                <input type="checkbox" class="chk" data-addon="1% Milk" data-extra="0" />
                            </div>
                        </div>
                    </div>

                    <div class="addin-toggle py-4 border-b border-gray-600 pl-2 flex flex-col cursor-pointer">
                        <div class="flex justify-between items-center">
                            <h4 class="font-semibold">Sweetness Level</h4>
                            <span
                                class="material-symbols-outlined text-white text-[20px] addin-arrow">chevron_right</span>
                        </div>
                        <div class="addin-body pt-3 hidden">
                            <div class="bg-black py-3 px-4 rounded flex justify-between items-center my-2">
                                <h4 class="text-sm tracking-wide">100% Sweet</h4>
                                <input type="checkbox" class="chk" data-addon="100% Sweet" data-extra="0" />
                            </div>
                            <div class="bg-black py-3 px-4 rounded flex justify-between items-center my-2">
                                <h4 class="text-sm tracking-wide">50% Sweet</h4>
                                <input type="checkbox" class="chk" data-addon="50% Sweet" data-extra="0" />
                            </div>
                            <div class="bg-black py-3 px-4 rounded flex justify-between items-center my-2">
                                <h4 class="text-sm tracking-wide">25% Sweet</h4>
                                <input type="checkbox" class="chk" data-addon="25% Sweet" data-extra="0" />
                            </div>
                            <div class="bg-black py-3 px-4 rounded flex justify-between items-center my-2">
                                <h4 class="text-sm tracking-wide">Extra Sweet</h4>
                                <div class="flex items-center gap-2">
                                    <span class="text-xs text-gray-400">$0.25</span>
                                    <input type="checkbox" class="chk" data-addon="Extra Sweet" data-extra="0.25" />
                                </div>
                            </div>
                            <div class="bg-black py-3 px-4 rounded flex justify-between items-center my-2">
                                <h4 class="text-sm tracking-wide">No Sweet</h4>
                                <input type="checkbox" class="chk" data-addon="No Sweet" data-extra="0" />
                            </div>
                        </div>
                    </div>
                    <div class="addin-toggle py-4 border-b border-gray-600 pl-2 flex flex-col cursor-pointer">
                        <div class="flex justify-between items-center">
                            <h4 class="font-semibold">Add Whipped Cream</h4>
                            <span
                                class="material-symbols-outlined text-white text-[20px] addin-arrow">chevron_right</span>
                        </div>
                        <div class="addin-body pt-3 hidden">
                            <div class="bg-black py-3 px-4 rounded flex justify-between items-center my-2">
                                <h4 class="text-sm tracking-wide">Add Whipped Cream</h4>
                                <input type="checkbox" class="chk" data-addon="Whipped Cream" data-extra="0" />
                            </div>
                        </div>
                    </div>

                    <div class="addin-toggle py-4 border-b border-gray-600 pl-2 flex flex-col cursor-pointer">
                        <div class="flex justify-between items-center">
                            <h4 class="font-semibold">Special Instructions</h4>
                            <span class="material-symbols-outlined text-white text-[20px] addin-arrow">chevron_right</span>
                        </div>
                        <div class="addin-body pt-3 hidden">
                            <textarea id="note-input" rows="2" placeholder="e.g. Extra hot, no sugar..."
                                class="w-full bg-black border border-gray-600 rounded-xl px-4 py-3 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#af7b5c]"></textarea>
                        </div>
                    </div>

                    <div class="py-4 pl-2">
                        <h4 class="font-semibold mb-3">Quantity</h4>
                        <div class="flex justify-between items-center">
                            <div class="flex items-center gap-2 bg-[#3f444b] rounded-full p-1 text-sm">
                                <button id="qty-minus"
                                    class="flex justify-center items-center p-0.5 rounded-full bg-[#4f6972]"><span
                                        class="material-symbols-outlined">check_indeterminate_small</span></button>
                                <span id="qty-display" class="text-lg font-semibold min-w-[24px] text-center">1</span>
                                <button id="qty-plus"
                                    class="flex justify-center items-center p-0.5 rounded-full bg-[#4f6972]"><span
                                        class="material-symbols-outlined">add</span></button>
                            </div>
                            <button id="add-to-cart-btn" class="rounded-full bg-[#af7b5c] text-sm py-3 px-7">Add to Cart
                                <span id="total-price" class="font-semibold pl-3">$4.29</span></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="hidden lg:flex min-h-screen items-center justify-center bg-black text-white">
        <p class="opacity-70">Mobile & Tablet only</p>
    </div>
    <script src="app.js"></script>
    <script src="index.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var products = {
                "brewed-coffee": { name: "Brewed Coffee", price: 4.29, image: "https://images.unsplash.com/photo-1511920170033-f8396924c348", desc: "Fresh brewed house blend coffee", prep: "3–5 min" },
                "vanilla-cold-brew": { name: "Vanilla Cold Brew", price: 4.79, image: "https://images.unsplash.com/photo-1461023058943-07fcbe16d735", desc: "Slow-steeped cold brew with vanilla", prep: "2–4 min" },
                "espresso-shot": { name: "Espresso Shot", price: 3.29, image: "https://images.unsplash.com/photo-1521305916504-4a1121188589", desc: "Single or double shot", prep: "1–2 min" },
                "americano": { name: "Americano", price: 3.99, image: "https://images.unsplash.com/photo-1551030173-122aabc4489c", desc: "Espresso with hot water", prep: "2–3 min" },
                "caramel-latte": { name: "Caramel Latte", price: 5.49, image: "https://images.unsplash.com/photo-1509042239860-f550ce710b93", desc: "Espresso with steamed milk & caramel", prep: "4–6 min" },
                "cappuccino": { name: "Cappuccino", price: 5.19, image: "https://images.unsplash.com/photo-1534778101976-62847782c213", desc: "Double shot with foamed milk", prep: "3–5 min" },
                "iced-mocha": { name: "Iced Mocha", price: 5.99, image: "https://images.unsplash.com/photo-1572442388796-11668a67e53d", desc: "Chilled espresso with chocolate & milk", prep: "4–6 min" },
                "bagel-cream-cheese": { name: "Bagel & Cream Cheese", price: 3.60, image: "https://images.unsplash.com/photo-1504754524776-8f4f37790ca0", desc: "Toasted bagel with cream cheese", prep: "3–5 min" },
                "butter-croissant": { name: "Butter Croissant", price: 3.25, image: "https://images.unsplash.com/photo-1530610476181-d83430b64dcd", desc: "Freshly baked flaky croissant", prep: "2–3 min" }
            };
            var params = new URLSearchParams(window.location.search);
            var pid = params.get("id") || "brewed-coffee";
            var product = products[pid] || products["brewed-coffee"];
            document.getElementById("hero-img").src = product.image;
            document.getElementById("product-name").textContent = product.name;
            document.getElementById("product-desc").textContent = product.desc;
            document.getElementById("base-price-display").textContent = "$" + product.price.toFixed(2);
            document.getElementById("breadcrumb-product").textContent = product.name;
            document.getElementById("prep-value").textContent = "~" + product.prep;
            document.title = product.name + " — PickBrew";
            document.getElementById("product-loader").style.display = "none";
            document.getElementById("product-content").style.display = "";
            var state = { size: "Medium", strength: "Regular", flavor: "None", addons: [], qty: 1 };
            var basePrice = product.price;
            var ACTIVE_SIZE = "opt-btn size-card py-3 rounded-xl text-center bg-[#af7b5c] text-black";
            var INACTIVE_SIZE = "opt-btn size-card py-3 rounded-xl text-center border border-gray-600 text-gray-300";

            function calcPrice() {
                var extra = 0;
                document.querySelectorAll(".option-group").forEach(function (g) {
                    var active = g.querySelector(".opt-btn.bg-\\[\\#af7b5c\\]") || g.querySelector('[class*="bg-[#af7b5c]"]');
                    if (active) extra += parseFloat(active.dataset.extra || 0);
                });
                document.querySelectorAll(".chk:checked").forEach(function (c) {
                    extra += parseFloat(c.dataset.extra || 0);
                });
                var unitPrice = basePrice + extra;
                var total = unitPrice * state.qty;
                document.getElementById("total-price").textContent = "$" + total.toFixed(2);
            }
            document.querySelectorAll(".option-group").forEach(function (group) {
                group.querySelectorAll(".opt-btn").forEach(function (btn) {
                    btn.addEventListener("click", function () {
                        group.querySelectorAll(".opt-btn").forEach(function (b) {
                            b.className = INACTIVE_SIZE;
                        });
                        btn.className = ACTIVE_SIZE;
                        state[group.dataset.option] = btn.dataset.value;
                        calcPrice();
                    });
                });
            });

            document.getElementById("qty-minus").addEventListener("click", function () {
                if (state.qty > 1) { state.qty--; document.getElementById("qty-display").textContent = state.qty; calcPrice(); }
            });
            document.getElementById("qty-plus").addEventListener("click", function () {
                state.qty++; document.getElementById("qty-display").textContent = state.qty; calcPrice();
            });

            var favIcon = document.getElementById("fav-icon");
            function updateFavIcon() {
                favIcon.textContent = PickBrew.isFavorite(pid) ? "favorite" : "favorite_border";
                favIcon.style.color = PickBrew.isFavorite(pid) ? "#ef4444" : "white";
            }
            updateFavIcon();
            document.getElementById("fav-btn").addEventListener("click", function () {
                PickBrew.toggleFavorite({ id: pid, name: product.name, price: product.price, image: product.image, desc: product.desc });
                updateFavIcon();
                PickBrew.showToast(PickBrew.isFavorite(pid) ? "Added to favorites" : "Removed from favorites");
            });

            // Live price update when checkboxes change
            document.querySelectorAll(".chk").forEach(function (chk) {
                chk.addEventListener("change", function () { calcPrice(); });
            });

            document.getElementById("add-to-cart-btn").addEventListener("click", function () {
                var addons = [];
                var addonExtra = 0;
                document.querySelectorAll(".chk:checked").forEach(function (c) {
                    addons.push(c.dataset.addon);
                    addonExtra += parseFloat(c.dataset.extra || 0);
                });
                var sizeExtra = 0;
                document.querySelectorAll(".option-group").forEach(function (g) {
                    var active = g.querySelector('[class*="bg-[#af7b5c]"]');
                    if (active) sizeExtra += parseFloat(active.dataset.extra || 0);
                });
                var noteEl = document.getElementById("note-input");
                PickBrew.addToCart({
                    id: pid,
                    name: product.name,
                    price: basePrice + sizeExtra + addonExtra,
                    image: product.image,
                    desc: product.desc,
                    size: state.size,
                    strength: state.strength,
                    flavor: state.flavor,
                    addons: addons,
                    note: noteEl ? noteEl.value : "",
                    qty: state.qty
                });
                PickBrew.showToast("Added " + state.qty + "x " + product.name + " to cart");
                setTimeout(function () { window.location.href = "cart.html"; }, 800);
            });
            calcPrice();

            // Add-ins accordion toggle
            document.querySelectorAll(".addin-toggle").forEach(function (toggle) {
                toggle.addEventListener("click", function (e) {
                    if (e.target.classList.contains("chk") || e.target.tagName === "TEXTAREA" || e.target.tagName === "INPUT") return;
                    var body = toggle.querySelector(".addin-body");
                    var isOpen = toggle.classList.contains("open");
                    // Close all
                    document.querySelectorAll(".addin-toggle").forEach(function (t) {
                        t.classList.remove("open");
                        t.querySelector(".addin-body").classList.add("hidden");
                    });
                    // Open clicked if it was closed
                    if (!isOpen) {
                        toggle.classList.add("open");
                        body.classList.remove("hidden");
                    }
                });
            });
        });
    </script>
</body>

</html>